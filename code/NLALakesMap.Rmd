---
title: "NLALakesMap"
author: "Amalia Handler"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library(dplyr)
library(sf)
library(ggplot2)

# Load the NLA lake used for population condition estimates
nla_df <- read.csv('./data/NLA_Comb_2007-2017_IndexVisits_withElevationClass.csv')

# Convert to sf object
nla_sf <- st_as_sf(nla_df, coords = c('XCOORD', 'YCOORD'))

# Get CONUS shapefile
conus <- st_as_sf(USAboundaries::us_states())
conus <- conus[!conus$name %in% c('Alaska','Hawaii','Puerto Rico'), ]

# Set the projection to Albers equal area
conus <- st_transform(conus, '+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs')
nla_albers   <- st_set_crs(nla_sf, st_crs(conus)) 

# Order the levels of the elevation class
nla <- nla_albers %>%
  mutate(ELEV_CLASS = factor(ELEV_CLASS, levels = c("Lower lakes < 6,000 ft", "Subalpine 6,000 ft < 10,000 ft", "Alpine >= 10,000 ft"))) %>%
  arrange(ELEV_CLASS)

# Make the map showing elevation classes of lakes
ggplot() + 
  geom_sf(data = conus, fill = "#e2e2e2", color = "white", size = 0.5) +
  geom_sf(data = nla, shape = 21, aes(fill = ELEV_CLASS), size = 1.5, stroke = .2) +
  scale_fill_manual(breaks = levels(nla$ELEV_CLASS),
                    name = "NLA Lake Elevation",
                    values = c('#A8ACDB', '#9016DB', '#00D6DB'),
                    guide = guide_legend(reverse = TRUE)) +
  theme_void()
  
ggsave("./figures/NLALakeElevation.png", width = 8, height = 3.5, units = "in", dpi = 600, bg = 'white')
```

